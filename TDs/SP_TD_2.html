<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        STREAM PROCESSING : TRAVAUX PRATIQUES/ SUITE - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,\\30D2\30E9\30AE\30CE\89D2\30B4 Pro W3,Osaka,Meiryo,\\30E1\30A4\30EA\30AA,MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,\\5FAE\8EDF\6B63\9ED1,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,\\5FAE\8EDF\6B63\9ED1UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,\\5FAE\8F6F\96C5\9ED1,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,\\5FAE\8F6F\96C5\9ED1UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid"><h1 id="STREAM-PROCESSING--TRAVAUX-PRATIQUES-SUITE" style=""><a class="anchor hidden-xs" href="#STREAM-PROCESSING--TRAVAUX-PRATIQUES-SUITE" title="STREAM-PROCESSING--TRAVAUX-PRATIQUES-SUITE"><span class="octicon octicon-link"></span></a>STREAM PROCESSING : TRAVAUX PRATIQUES/ SUITE</h1><h2 id="OBJECTIFS" style=""><a class="anchor hidden-xs" href="#OBJECTIFS" title="OBJECTIFS"><span class="octicon octicon-link"></span></a>OBJECTIFS</h2><ul>
<li>Création d’un “Log Producer” simulant des streams</li>
<li>Appréhender une librairie de configuration: Typesafe Config</li>
<li>Manipuler un Broker Kafka</li>
</ul><h2 id="INGESTION-DE-DONNEES" style=""><a class="anchor hidden-xs" href="#INGESTION-DE-DONNEES" title="INGESTION-DE-DONNEES"><span class="octicon octicon-link"></span></a>INGESTION DE DONNEES</h2><p>Le but de cette partie est de produire des données de logs similaires à la capture ci-dessous en nous aidant des deux jeux de données .csv du git.</p><p><img src="https://i.imgur.com/wdc8q6A.png" alt=""></p><h4 id="KAFKA-PRODUCER" style=""><a class="anchor hidden-xs" href="#KAFKA-PRODUCER" title="KAFKA-PRODUCER"><span class="octicon octicon-link"></span></a>KAFKA PRODUCER</h4><ul>
<li>
<p>Supprimez le module-1 créé précédement sur votre IDE.<br>
<img src="https://i.imgur.com/9xecx4Y.png" alt=""></p>
</li>
<li>
<p>Créez un nouveau module sous le nom “spark-lambda”.</p>
</li>
</ul><p><img src="https://i.imgur.com/a4pJ98y.png" alt=""></p><ul>
<li>
<p>Rajoutez le support du framework Scala.<br>
<img src="https://i.imgur.com/dcMYFEt.png" alt=""></p>
</li>
<li>
<p>Supprimez le sous dossier Java car nous ne ferons pas de code Java.</p>
</li>
</ul><p><img src="https://i.imgur.com/qM8FzLG.png" alt=""></p><ul>
<li>Marquez le sous-répértoire scala en tant que “source”.</li>
</ul><p><img src="https://i.imgur.com/6GBx701.png" alt=""></p><ul>
<li>Copiez les deux fichiers “referrers.csv” et “products.csv” dans le sous-répértoire “resources”.</li>
</ul><p><img src="https://i.imgur.com/pZhZCeB.png" alt=""></p><ul>
<li>Dans le pom du projet, supprimez le module 1 pour nettoyer le fichier puis rajoutez la dépendance ci-dessous.</li>
</ul><p><img src="https://i.imgur.com/nRUwWy5.png" alt=""></p><ul>
<li>
<p>Créez deux packages sous votre répértoire scala.<br>
<img src="https://i.imgur.com/jbHU3Xc.png" alt=""></p>
</li>
<li>
<p>La librarie Typesafe config a besoin d’un fichier .conf présent dans votre sous-répértoire “ressources”. Créez le fichier “application.conf” et rajoutez-y le code suivant.</p>
</li>
</ul><pre><code>clickstream {

 records = 200

 time_multiplier = 480

 pages = 15

 visitors = 1000000

 file_path = "C:\\\boxes\StreamProcessing\\\Vagrant\\\data.tsv"

}

</code></pre><ul>
<li>Vous devriez obtenir un résultat similaire. La dernière ligne est le dossier contenant le dossier partagé entre la machine hôte et la VM et qui contiendra le fichier de résultat.</li>
</ul><p><img src="https://i.imgur.com/KEehkBf.png" alt=""></p><ul>
<li>Dans le package “config”, créez une classe objet scala “Settings” responsable de lire le fichier de config. Ajoutez-y le code suivant.</li>
</ul><pre><code>private val config = ConfigFactory.load()  
  
object WebLogGen {  
  private val weblogGen = config.getConfig("clickstream")  
  
  lazy val records = weblogGen.getInt("records")  
  lazy val timeMultiplier = weblogGen.getInt("time_multiplier")  
  lazy val pages = weblogGen.getInt("pages")  
  lazy val visitors = weblogGen.getInt("visitors")  
  lazy val filePath = weblogGen.getString("file_path")
</code></pre><ul>
<li>Le résultat devrait être similaire à la capture suivante.</li>
</ul><p><img src="https://i.imgur.com/gokv59K.png" alt=""></p><ul>
<li>Copiez le code du logproducer suivant dans votre classe “LogProducer”.</li>
</ul><pre><code>package clickstream  
  
import java.io.FileWriter  
  
import config.Settings  
  
import scala.util.Random  
  
  
object LogProducer extends App {  
  // WebLog config  
   val wlc = Settings.WebLogGen  
  
  val Products = scala.io.Source.fromInputStream(getClass.getResourceAsStream("/products.csv")).getLines().toArray  
  val Referrers = scala.io.Source.fromInputStream(getClass.getResourceAsStream("/referrers.csv")).getLines().toArray  
  val Visitors = (0 to wlc.visitors).map("Visitor-" \+ _)  
  val Pages = (0 to wlc.pages).map("Page-" \+ _)  
  
  val rnd = new Random()  
  
  val filePath = wlc.filePath  
   val fw = new FileWriter(filePath, true)  
  
  // introduce a bit of randomness to time increments for demo purposes  
   val incrementTimeEvery = rnd.nextInt(math.min(wlc.records, 100) \- 1) \+ 1  
  
   var timestamp = System.currentTimeMillis()  
  var adjustedTimestamp = timestamp  
  
  for (iteration &lt;- 1 to wlc.records) {  
    adjustedTimestamp = adjustedTimestamp + ((System.currentTimeMillis() - timestamp) * wlc.timeMultiplier)  
    timestamp = System.currentTimeMillis() // move all this to a function  
   val action = iteration % (rnd.nextInt(200) \+ 1) match {  
      case 0 =\&gt; "purchase"  
   case 1 =\&gt; "add\_to\_cart"  
   case _ =&gt; "page_view"  
   }  
    val referrer = Referrers(rnd.nextInt(Referrers.length - 1))  
    val prevPage = referrer match {  
      case "Internal" =\&gt; Pages(rnd.nextInt(Pages.length - 1))  
      case _ =&gt; ""  
   }  
    val visitor = Visitors(rnd.nextInt(Visitors.length - 1))  
    val page = Pages(rnd.nextInt(Pages.length - 1))  
    val product = Products(rnd.nextInt(Products.length - 1))  
  
    val line = s"$adjustedTimestamp\\t$referrer\\t$action\\t$prevPage\\t$visitor\\t$page\\t$product\\n"  
   fw.write(line)  
  
    if (iteration % incrementTimeEvery == 0) {  
      println(s"Sent $iteration messages!")  
      val sleeping = rnd.nextInt(1500)  
      println(s"Sleeping for $sleeping ms")  
      Thread sleep sleeping  
    }  
  
  }  
  fw.close()  
}

</code></pre><ul>
<li>Si vous lancez votre classe “LogProducer”, vous devriez obtenir un fichier .tsv enregistré dans le dossier partagé.</li>
</ul><p><img src="https://i.imgur.com/u3WU92A.png" alt=""></p><ul>
<li>Ce fichier contient la liste des logs simulés comme suit.</li>
</ul><p><img src="https://i.imgur.com/lmslzx2.png" alt=""></p><h5 id="Package-Batch"><a class="anchor hidden-xs" href="#Package-Batch" title="Package-Batch"><span class="octicon octicon-link"></span></a>Package Batch</h5><ul>
<li>Créez un nouveau package “batch” contenant une classe objet nommée “BatchJob”.</li>
</ul><p><img src="https://i.imgur.com/OKvOyM4.png" alt=""></p><ul>
<li>Rajoutez l’ensemble des dépendances dans le pom du projet afin de ne pas avoir à le faire à chaque étape. Votre pom doit contenir les informations suivantes, l’installation des dépendances prend plusieurs minutes selon votre connexion.</li>
</ul><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;  
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"  
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
   xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;  
 &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;  
  
 &lt;groupId&gt;fr.univ-paris-est&lt;/groupId&gt;  
 &lt;artifactId&gt;stream-processing&lt;/artifactId&gt;  
 &lt;packaging&gt;pom&lt;/packaging&gt;  
 &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;  
 &lt;modules&gt; &lt;module&gt;sparklambda&lt;/module&gt;  
 &lt;/modules&gt;  
 &lt;properties&gt; &lt;spark.version&gt;1.6.0&lt;/spark.version&gt;  
 &lt;chill.version&gt;0.7.2&lt;/chill.version&gt;  
 &lt;algebird.version&gt;0.11.0&lt;/algebird.version&gt;  
 &lt;kafka.clients.version&gt;0.8.2.1&lt;/kafka.clients.version&gt;  
 &lt;avro.version&gt;1.7.7&lt;/avro.version&gt;  
 &lt;spark-cassandra-connector.version&gt;1.6.1&lt;/spark-cassandra-connector.version&gt;  
 &lt;cassandra-driver-core.version&gt;3.0.1&lt;/cassandra-driver-core.version&gt;  
 &lt;nscala-time.version&gt;2.6.0&lt;/nscala-time.version&gt;  
 &lt;/properties&gt;  
 &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.typesafe&lt;/groupId&gt;  
 &lt;artifactId&gt;config&lt;/artifactId&gt;  
 &lt;version&gt;1.3.0&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;com.datastax.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-cassandra-connector_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark-cassandra-connector.version}&lt;/version&gt;  
 &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.datastax.cassandra&lt;/groupId&gt;  
 &lt;artifactId&gt;cassandra-driver-core&lt;/artifactId&gt;  
 &lt;version&gt;${cassandra-driver-core.version}&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;com.github.nscala-time&lt;/groupId&gt;  
 &lt;artifactId&gt;nscala-time_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${nscala-time.version}&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;  
 &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;  
 &lt;version&gt;${kafka.clients.version}&lt;/version&gt;  
 &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt;  
 &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;  
 &lt;version&gt;1.7.7&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;com.twitter&lt;/groupId&gt;  
 &lt;artifactId&gt;chill_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${chill.version}&lt;/version&gt;  
 &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.twitter&lt;/groupId&gt;  
 &lt;artifactId&gt;chill-avro_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${chill.version}&lt;/version&gt;  
 &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.twitter&lt;/groupId&gt;  
 &lt;artifactId&gt;algebird-core_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${algebird.version}&lt;/version&gt;  
 &lt;/dependency&gt;  
  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-core_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;scope&gt;compile&lt;/scope&gt;  
   &lt;!\-\- provided --&gt;  
   &lt;/dependency&gt;  
  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;  
 &lt;artifactId&gt;kafka_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${kafka.clients.version}&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-streaming_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;scope&gt;compile&lt;/scope&gt;  
   &lt;!\-\- provided --&gt;  
   &lt;/dependency&gt;  
  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-sql_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;scope&gt;compile&lt;/scope&gt;  
   &lt;!\-\- provided --&gt;  
   &lt;/dependency&gt;  
  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-streaming-kafka_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-streaming-kafka-assembly_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-mllib_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;scope&gt;compile&lt;/scope&gt;  
   &lt;!\-\- provided --&gt;  
   &lt;/dependency&gt;  
  
 &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;  
 &lt;artifactId&gt;spark-hive_2.11&lt;/artifactId&gt;  
 &lt;version&gt;${spark.version}&lt;/version&gt;  
 &lt;scope&gt;compile&lt;/scope&gt;  
   &lt;!\-\- provided --&gt;  
   &lt;/dependency&gt;  
  
 &lt;dependency&gt; &lt;groupId&gt;joda-time&lt;/groupId&gt;  
 &lt;artifactId&gt;joda-time&lt;/artifactId&gt;  
 &lt;version&gt;2.8.1&lt;/version&gt;  
 &lt;/dependency&gt;  
 &lt;dependency&gt; &lt;groupId&gt;org.joda&lt;/groupId&gt;  
 &lt;artifactId&gt;joda-convert&lt;/artifactId&gt;  
 &lt;version&gt;1.7&lt;/version&gt;  
 &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;sourceDirectory&gt;src/main/scala&lt;/sourceDirectory&gt;  
 &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;  
 &lt;artifactId&gt;scala-maven-plugin&lt;/artifactId&gt;  
 &lt;version&gt;3.1.6&lt;/version&gt;  
 &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;compile&lt;/phase&gt;  
 &lt;goals&gt; &lt;goal&gt;compile&lt;/goal&gt;  
 &lt;goal&gt;testCompile&lt;/goal&gt;  
 &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt;  
 &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;  
 &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;  
 &lt;version&gt;2.3&lt;/version&gt;  
 &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt;  
 &lt;goals&gt; &lt;goal&gt;shade&lt;/goal&gt;  
 &lt;/goals&gt; &lt;configuration&gt; &lt;shadedArtifactAttached&gt;true&lt;/shadedArtifactAttached&gt;  
 &lt;filters&gt; &lt;filter&gt; &lt;artifact&gt;*:*&lt;/artifact&gt;  
 &lt;excludes&gt; &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;  
 &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;  
 &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;  
 &lt;/excludes&gt; &lt;/filter&gt; &lt;/filters&gt; &lt;artifactSet&gt; &lt;includes&gt; &lt;include&gt;*:*&lt;/include&gt;  
 &lt;/includes&gt; &lt;/artifactSet&gt; &lt;transformers&gt; &lt;transformer   implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"&gt;  
 &lt;resource&gt;reference.conf&lt;/resource&gt;  
 &lt;/transformer&gt; &lt;/transformers&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt;  
 &lt;/plugins&gt; &lt;/build&gt;  
  
&lt;/project&gt;

</code></pre><ul>
<li>Afin de soumettre les différentes opérations de création des logs générées à notre cluster spark sous yarn, nous avons besoin d’une d’indiquer les différentes instructions sous forme d’un contexte spark. Le code scala permettant de faire cela à rajouter dans la classe BatchJob est le suivant.</li>
</ul><pre><code>package batch  
  
import java.lang.management.ManagementFactory  
import org.apache.spark.{SparkContext, SparkConf}  
import org.apache.spark.sql.{SaveMode, SQLContext}  
import domain._  
  
  
object BatchJob {  
  def main (args: Array\[String\]): Unit = {  
  
    // get spark configuration  
   val conf = new SparkConf()  
      .setAppName("Lambda with Spark")  
  
    // Check if running from IDE  
   if (ManagementFactory.getRuntimeMXBean.getInputArguments.toString.contains("IntelliJ IDEA")) {  
      System.setProperty("hadoop.home.dir", "C:\\\hadoop-2.6.0") // required for winutils  
   conf.setMaster("local\[*\]")  
    }  
  
    // setup spark context  
   val sc = new SparkContext(conf)  
    implicit val sqlContext = new SQLContext(sc)  
  
    import org.apache.spark.sql.functions._  
    import sqlContext.implicits._  
  
    // initialize input RDD  
   val sourceFile = "file:///vagrant/data.tsv"  
   val input = sc.textFile(sourceFile)  
  
    val inputDF = input.flatMap{ line =&gt;  
      val record = line.split("\\\t")  
      val MS\_IN\_HOUR = 1000 \* 60 \* 60  
   if (record.length == 7)  
        Some(Activity(record(0).toLong / MS\_IN\_HOUR * MS\_IN\_HOUR, record(1), record(2), record(3), record(4), record(5), record(6)))  
      else  
   None  
    }.toDF()  
  
    val df = inputDF.select(  
      add_months(from_unixtime(inputDF("timestamp_hour") / 1000), 1).as("timestamp_hour"),  
   inputDF("referrer"), inputDF("action"), inputDF("prevPage"), inputDF("page"), inputDF("visitor"), inputDF("product")  
    ).cache()  
  
    df.registerTempTable("activity")  
    val visitorsByProduct = sqlContext.sql(  
      """SELECT product, timestamp\_hour, COUNT(DISTINCT visitor) as unique\_visitors  
 |FROM activity GROUP BY product, timestamp_hour """.stripMargin)  
  
    val activityByProduct = sqlContext.sql("""SELECT  
 product, timestamp_hour, sum(case when action = 'purchase' then 1 else 0 end) as purchase_count, sum(case when action = 'add\_to\_cart' then 1 else 0 end) as add\_to\_cart_count, sum(case when action = 'page\_view' then 1 else 0 end) as page\_view_count from activity group by product, timestamp_hour """).cache()  
  
    activityByProduct.write.partitionBy("timestamp_hour").mode(SaveMode.Append).parquet("hdfs://lambda-pluralsight:9000/lambda/batch1")  
  
    visitorsByProduct.foreach(println)  
    activityByProduct.foreach(println)  
  
  }  
}

</code></pre><ul>
<li>
<p>ATTENTION: il y a un chemin à changer dans le code précédent concernant la librarie hadoop( System.setProperty(“hadoop.home.dir”, “C:\\hadoop-2.6.0”)). En effet, s’agissant de windows, vous devez télécharger la librarie winutils.exe et indiquer son chemin d’accès à spark pour permettre le lancement des jobs.</p>
</li>
<li>
<p>Ensuite, il faut package notre code sous format de shaded jar. Celui-ci devra être copié dans le répértoire partagé contenant le fichier data.tsv.</p>
</li>
</ul><p><img src="https://i.imgur.com/Y9KRRX9.png" alt=""></p><ul>
<li>Connectez vous ensuite à la VM en utilisant la commande “vagrant ssh” sous votre terminal puis naviguez vers le dossier /pluralsight/spark. Rentrez ensuite la commande suivante permettrant de soumettre l’application:</li>
</ul><pre><code>./bin/spark-submit --master yarn --deploy-mode cluster --class batch.BatchJob /vagrant/spark-lambda-1.0-SNAPSHOT-shaded.jar
</code></pre><ul>
<li>Vous devriez voir sur votre terminal les logs suivantes:</li>
</ul><p><img src="https://i.imgur.com/kOpLntq.png" alt=""></p><ul>
<li>Ouvrez votre navigateur puis connectez vouos au cluster hadoop : “localhost:8088”. Vous devriez apercevoir une application qui tourne (dans mon cas j’en ai 3).</li>
</ul><p><img src="https://i.imgur.com/pzufWOD.png" alt=""></p><ul>
<li>Afin de suivre le fonctionnement de l’application, cliquez sur “applicationMaster”</li>
</ul><p><img src="https://i.imgur.com/sfv5Z63.png" alt=""></p><ul>
<li>Vous devriez obtenir une page de gestion spécifique donnant des informations générales sur votre soumission.</li>
</ul><p><img src="https://i.imgur.com/MkAAnUc.png" alt=""></p><ul>
<li>Puisqu’il s’agit de Spark, il dispose de sa propre UI offrant une granularité fine de monitoring des jobs. Cliquez sur “ApplicationMaster” à nouveau, vous serez redirigés vers l’UI de Spark.</li>
</ul><p><img src="https://i.imgur.com/63miixB.png" alt=""></p><ul>
<li>Pour visualiser les fichiers matérialisés suite à nos  d’aggrégation, naviguez votre namenode UI. Elle se situe sur le port 50070 et contient l’ensemble des informations de configuration.</li>
</ul><p><img src="https://i.imgur.com/fY10HGb.png" alt=""></p><ul>
<li>Naviguez vers la page de gestion des fichiers.</li>
</ul><p><img src="https://i.imgur.com/dI0frCu.png" alt=""></p><ul>
<li>En tapant le nom de notre application “lambda”, hadoop retrouve le dossier batch1 sous hdfs.</li>
</ul><p><img src="https://i.imgur.com/yvt0jyT.png" alt=""></p><ul>
<li>En cliquant sur ce dossier, vous pourrez visualiser les données  agrégées par timestamp dans notre code scala.</li>
</ul><p><img src="https://i.imgur.com/HEKDNEs.png" alt=""></p><ul>
<li>La liste des fichiers devrait ressembler à ceci.</li>
</ul><p><img src="https://i.imgur.com/Sdccto6.png" alt=""></p><ul>
<li>Naviguez vers le port 8988 de votre machine puis créez une nouvelle note nommée “batch1”.</li>
</ul><p><img src="https://i.imgur.com/isuhijE.png" alt=""></p><ul>
<li>Pour visualiser le résultat de notre application, utilisez le code suivant.</li>
</ul><pre><code>val pDF = sqlContext.read.parquet("hdfs://lambda-pluralsight:9000/lambda/batch1/")

pDF.show()
</code></pre><ul>
<li>Vous devriez obtenir une table similaire à la capture ci-dessous.</li>
</ul><p><img src="https://i.imgur.com/aBHCK7M.png" alt=""></p><ul>
<li>Pour réaliser des opérations de tri directement via un DSL connu (sql par exemple), changez la syntaxe de votre code scala vers ce qui suit.</li>
</ul><pre><code>val pDF = sqlContext.sql("SELECT * FROM parquet.`hdfs://lambda-pluralsight:9000/lambda/batch1/` WHERE page_view_count &gt; 2")

pDF.show()
</code></pre><ul>
<li>La nouvelle table que vous obtenez ne contient que les logs relatant des vues de page supérieures à 2.</li>
</ul><p><img src="https://i.imgur.com/WE7j35i.png" alt=""></p><ul>
<li>Enregistrez la table temporaire sous le nom “source”.</li>
</ul><p><img src="https://i.imgur.com/yGIFbJK.png" alt=""></p><ul>
<li>BONUS +3 NOTE EXAMEN : Ecrivez une requête sql décrivant la relation entre le nombre de caractères d’un produit et le nombre de vues par page. De combien de caractères est constitué le produit qui a enregistré le plus de vues ?</li>
</ul></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav"><li class=""><a href="#STREAM-PROCESSING--TRAVAUX-PRATIQUES-SUITE">STREAM PROCESSING : TRAVAUX PRATIQUES/ SUITE</a><ul class="nav"><li><a href="#OBJECTIFS">OBJECTIFS</a></li><li><a href="#INGESTION-DE-DONNEES">INGESTION DE DONNEES</a><ul class="nav"><li><a href="#KAFKA-PRODUCER">KAFKA PRODUCER</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav"><li class=""><a href="#STREAM-PROCESSING--TRAVAUX-PRATIQUES-SUITE">STREAM PROCESSING : TRAVAUX PRATIQUES/ SUITE</a><ul class="nav"><li><a href="#OBJECTIFS">OBJECTIFS</a></li><li><a href="#INGESTION-DE-DONNEES">INGESTION DE DONNEES</a><ul class="nav"><li><a href="#KAFKA-PRODUCER">KAFKA PRODUCER</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
